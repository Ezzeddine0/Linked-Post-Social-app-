<section class="comments">
  @for (comment of comments; track comment._id) {
  <div class="p-4 mb-2 bgeee border">
    <div class="d-flex justify-content-between align-items-center">
      <div class="d-flex gap-3 align-items-center">
        <img
          class="rounded-circle"
          src="./assets/images/profile.png"
          width="30px"
          height="30px"
          alt=""
        />
        <p class="fw-bolder m-0">
          {{ comment.commentCreator.name }}
        </p>

        <p class="text-muted m-0">{{ comment.createdAt | date }}</p>
      </div>
      <!-- Dropdown -->
      @if (comment.commentCreator._id ===userData._id) {
      <div class="dropdown d-flex align-items-center justify-content-center">
        <button
          class="btn p-0 d-flex align-items-center justify-content-center"
          type="button"
          id="dropdownMenuButton"
          data-bs-toggle="dropdown"
          aria-expanded="false"
        >
          <p class="h2 fw-bold m-0">...</p>
        </button>
        <ul
          class="dropdown-menu dropdown-menu-end"
          aria-labelledby="dropdownMenuButton"
          style="width: auto; min-width: fit-content"
        >
          <li>
            <button
              class="dropdown-item text-main text-center fw-bold"
              (click)="startEdit(comment)"
            >
              Edit
            </button>
          </li>
          <li><hr class="dropdown-divider" /></li>
          <li>
            <button
              (click)="deleteComment(comment._id)"
              class="dropdown-item text-danger fw-bold"
            >
              Delete
            </button>
          </li>
        </ul>
      </div>
      }

      <!-- edit -->
    </div>
    @if (editingCommentId !== comment._id) {
    <p class="fw-bold text-muted mb-0">{{ comment.content }}</p>
    } @else {
    <div class="d-flex gap-2 align-items-center mt-2">
      <input
        [(ngModel)]="editContent"
        class="form-control p-2 rounded flex-grow-1"
        placeholder="Edit your comment"
        type="text"
      />
      <button
        (click)="saveEdit(comment._id)"
        class="btn btn-sm btn-success"
        [disabled]="!editContent.trim()"
      >
        Save
      </button>
      <button (click)="cancelEdit()" class="btn btn-sm btn-secondary">
        Cancel
      </button>
    </div>
    }
  </div>
  }
</section>
<form action="" [formGroup]="commentForm" (ngSubmit)="submitComment()">
  <div class="bgeee d-flex gap-2 p-3 align-items-center mt-2">
    <input
      name="content"
      id="content"
      formControlName="content"
      class="form-control p-2 rounded"
      placeholder="Your Comment"
      type="text"
    />
    <input
      name="post"
      id="post"
      formControlName="post"
      class="form-control p-2 rounded"
      type="hidden"
    />
    <button [disabled]="isLoading" class="btn text-center" type="submit">
      <i class="fa-solid fa-paper-plane fs-4"></i>
    </button>
  </div>
</form>
